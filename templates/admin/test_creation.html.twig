{% extends 'admin/base.html.twig' %}

{% block title %}Тест создания объектов{% endblock %}
{% block page_title %}Тест создания объектов{% endblock %}

{% block content %}
<div class="bg-white rounded-md shadow p-6">
    <h2>Тест создания категорий, моделей и тегов</h2>
    
    <div class="space-y-6 mt-6">
        <div>
            <h3>Создание категории</h3>
            <input type="text" id="category-name" placeholder="Название категории" class="w-full px-3 py-2 border border-gray-300 rounded-md">
            <button onclick="testCategoryCreation()" class="mt-2 bg-blue-600 text-white px-4 py-2 rounded">Создать категорию</button>
            <div id="category-result" class="mt-2 p-2 bg-gray-100 rounded"></div>
        </div>
        
        <div>
            <h3>Создание модели</h3>
            <input type="text" id="model-name" placeholder="Имя модели" class="w-full px-3 py-2 border border-gray-300 rounded-md">
            <button onclick="testModelCreation()" class="mt-2 bg-purple-600 text-white px-4 py-2 rounded">Создать модель</button>
            <div id="model-result" class="mt-2 p-2 bg-gray-100 rounded"></div>
        </div>
        
        <div>
            <h3>Создание тега</h3>
            <input type="text" id="tag-name" placeholder="Название тега" class="w-full px-3 py-2 border border-gray-300 rounded-md">
            <button onclick="testTagCreation()" class="mt-2 bg-green-600 text-white px-4 py-2 rounded">Создать тег</button>
            <div id="tag-result" class="mt-2 p-2 bg-gray-100 rounded"></div>
        </div>
    </div>
</div>

<script>
function testCategoryCreation() {
    const name = document.getElementById('category-name').value.trim();
    if (!name) {
        alert('Введите название категории');
        return;
    }
    
    const xhr = new XMLHttpRequest();
    xhr.open('POST', '{{ path("admin_categories_create_ajax") }}', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            console.log('Category Response:', xhr.status, xhr.responseText);
            document.getElementById('category-result').innerHTML = 
                'Status: ' + xhr.status + '<br>Response: ' + xhr.responseText;
        }
    };
    
    xhr.send(JSON.stringify({ name: name }));
}

function testModelCreation() {
    const name = document.getElementById('model-name').value.trim();
    if (!name) {
        alert('Введите имя модели');
        return;
    }
    
    const xhr = new XMLHttpRequest();
    xhr.open('POST', '{{ path("admin_models_create_ajax") }}', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            console.log('Model Response:', xhr.status, xhr.responseText);
            document.getElementById('model-result').innerHTML = 
                'Status: ' + xhr.status + '<br>Response: ' + xhr.responseText;
        }
    };
    
    xhr.send(JSON.stringify({ name: name }));
}

function testTagCreation() {
    const name = document.getElementById('tag-name').value.trim();
    if (!name) {
        alert('Введите название тега');
        return;
    }
    
    const xhr = new XMLHttpRequest();
    xhr.open('POST', '{{ path("admin_tags_create_ajax") }}', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            console.log('Tag Response:', xhr.status, xhr.responseText);
            document.getElementById('tag-result').innerHTML = 
                'Status: ' + xhr.status + '<br>Response: ' + xhr.responseText;
        }
    };
    
    xhr.send(JSON.stringify({ name: name }));
}
</script>
{% endblock %}
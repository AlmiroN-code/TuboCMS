{% extends 'admin/base.html.twig' %}

{% block title %}{{ profile.id ? 'Редактировать профиль' : 'Новый профиль' }}{% endblock %}
{% block page_title %}{{ profile.id ? 'Редактировать профиль кодирования' : 'Новый профиль кодирования' }}{% endblock %}

{% block content %}
<div class="bg-white rounded-md shadow p-6 max-w-2xl">
    <form method="post">
        <div class="space-y-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Название</label>
                <input type="text" name="name" value="{{ profile.name }}" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ширина (px)</label>
                    {% set resolution_parts = profile.resolution ? profile.resolution|split('x') : ['1920', '1080'] %}
                    <input type="number" name="width" value="{{ resolution_parts[0] ?? 1920 }}" required min="320" max="7680"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Высота (px)</label>
                    <input type="number" name="height" value="{{ resolution_parts[1] ?? 1080 }}" required min="240" max="4320"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Битрейт (kbps)</label>
                    <input type="number" name="bitrate" value="{{ profile.bitrate ?? 5000 }}" required min="100" max="50000"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Порядок</label>
                    <input type="number" name="order_position" value="{{ profile.orderPosition ?? 0 }}" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Кодек</label>
                    <select name="codec" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="libx264" {{ profile.codec == 'libx264' ? 'selected' : '' }}>H.264 (libx264)</option>
                        <option value="libx265" {{ profile.codec == 'libx265' ? 'selected' : '' }}>H.265 (libx265)</option>
                        <option value="libvpx-vp9" {{ profile.codec == 'libvpx-vp9' ? 'selected' : '' }}>VP9</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Формат</label>
                    <select name="format" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="mp4" {{ profile.format == 'mp4' ? 'selected' : '' }}>MP4 (.mp4, .m4v) - Универсальный</option>
                        <option value="mov" {{ profile.format == 'mov' ? 'selected' : '' }}>MOV (.mov) - Apple формат</option>
                        <option value="avi" {{ profile.format == 'avi' ? 'selected' : '' }}>AVI (.avi) - Совместимый</option>
                        <option value="mkv" {{ profile.format == 'mkv' ? 'selected' : '' }}>MKV (.mkv) - Открытый контейнер</option>
                    </select>
                    <p class="mt-1 text-xs text-gray-500">
                        MP4 - лучший выбор для веба и стриминга
                    </p>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-md">
                <h4 class="text-sm font-medium text-gray-700 mb-2">Описание форматов:</h4>
                <ul class="text-xs text-gray-600 space-y-1">
                    <li><strong>MP4:</strong> Наиболее универсальный, идеален для веба и мобильных устройств</li>
                    <li><strong>MOV:</strong> Формат Apple, качественное видео, популярен на устройствах Apple</li>
                    <li><strong>AVI:</strong> Старый формат, хорошая совместимость, может быть большим по размеру</li>
                    <li><strong>MKV:</strong> Открытый контейнер, поддерживает множество дорожек, популярен для HD/4K</li>
                </ul>
            </div>

            <div class="flex items-center">
                <input type="checkbox" name="is_active" value="1" {{ profile.isActive ? 'checked' : '' }}
                       class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                <label class="ml-2 block text-sm text-gray-900">Активен</label>
            </div>

            <div class="flex space-x-4">
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded">
                    Сохранить
                </button>
                <a href="{{ path('admin_encoding_profiles') }}" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded">
                    Отмена
                </a>
            </div>
        </div>
    </form>
</div>
{% endblock %}

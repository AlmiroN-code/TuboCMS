<div id="model-subscribe-btn-{{ model.id }}"
     x-data="{ 
         subscribed: {{ is_subscribed ? 'true' : 'false' }},
         loading: false,
         async toggle() {
             if (this.loading) return;
             this.loading = true;
             try {
                 const response = await fetch('{{ path('model_subscription_toggle', {id: model.id}) }}', {
                     method: 'POST',
                     headers: {
                         'Content-Type': 'application/json',
                         'X-Requested-With': 'XMLHttpRequest'
                     }
                 });
                 if (response.ok) {
                     this.subscribed = !this.subscribed;
                 }
             } catch (error) {
                 console.error('Error:', error);
             } finally {
                 this.loading = false;
             }
         }
     }">
    {% if app.user %}
        <button @click="toggle()"
                :disabled="loading"
                :class="subscribed ? 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600' : 'bg-orange-600 text-white hover:bg-orange-700'"
                class="px-4 py-2 rounded-md font-medium transition disabled:opacity-50">
            <span x-text="subscribed ? '{{ 'model.unsubscribe'|trans }}' : '{{ 'model.subscribe'|trans }}'"></span>
        </button>
    {% else %}
        <a href="{{ path('app_login') }}" class="px-4 py-2 bg-orange-600 text-white rounded-md font-medium hover:bg-orange-700 transition">
            {{ 'model.subscribe'|trans }}
        </a>
    {% endif %}
</div>

{# Расчёт процента лайков для progress-bar #}
{% set total_votes = model.likesCount + model.dislikesCount %}
{% set like_percent = total_votes > 0 ? (model.likesCount / total_votes * 100)|round : 50 %}

<div id="model-like-buttons-{{ model.id }}" class="flex flex-col gap-2">
    <div class="flex items-center gap-2">
        {% if app.user %}
            {# Кнопка лайка #}
            <button 
                onclick="toggleModelLike({{ model.id }}, 'like', this)"
                class="model-like-btn flex items-center gap-1 px-3 py-1.5 rounded-md transition {{ user_like_type == 'like' ? 'bg-green-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900' }}"
                data-active="{{ user_like_type == 'like' ? 'true' : 'false' }}">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"/>
                </svg>
                <span class="likes-count">{{ model.likesCount|locale_number }}</span>
            </button>
            
            {# Кнопка дизлайка #}
            <button 
                onclick="toggleModelLike({{ model.id }}, 'dislike', this)"
                class="model-dislike-btn flex items-center gap-1 px-3 py-1.5 rounded-md transition {{ user_like_type == 'dislike' ? 'bg-red-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-900' }}"
                data-active="{{ user_like_type == 'dislike' ? 'true' : 'false' }}">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.106-1.79l-.05-.025A4 4 0 0011.057 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z"/>
                </svg>
                <span class="dislikes-count">{{ model.dislikesCount|locale_number }}</span>
            </button>
        {% else %}
            {# Для неавторизованных - ссылки на логин #}
            <a href="{{ path('app_login') }}" class="flex items-center gap-1 px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"/>
                </svg>
                <span>{{ model.likesCount|locale_number }}</span>
            </a>
            
            <a href="{{ path('app_login') }}" class="flex items-center gap-1 px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-900 transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.106-1.79l-.05-.025A4 4 0 0011.057 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z"/>
                </svg>
                <span>{{ model.dislikesCount|locale_number }}</span>
            </a>
        {% endif %}
    </div>
    
    {# Progress-bar рейтинга like/dislike #}
    <div id="model-like-progress-{{ model.id }}" class="flex h-1 w-full rounded-full overflow-hidden {% if total_votes == 0 %}bg-gray-300 dark:bg-gray-600{% endif %}"
         title="{{ like_percent }}% {{ 'model.likes'|trans|default('нравится') }}">
        {% if total_votes > 0 %}
            <div class="like-bar bg-green-500 h-full transition-all duration-300" style="width: {{ like_percent }}%"></div>
            <div class="dislike-bar bg-red-500 h-full transition-all duration-300" style="width: {{ 100 - like_percent }}%"></div>
        {% else %}
            <div class="bg-gray-400 dark:bg-gray-500 h-full w-full"></div>
        {% endif %}
    </div>
</div>

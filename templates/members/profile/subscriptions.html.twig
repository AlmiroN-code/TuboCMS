{% extends 'members/profile/base.html.twig' %}

{% block page_title %}{{ 'profile.tabs.subscriptions'|trans }}{% endblock %}

{% block tab_content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold text-gray-900">
            {{ 'profile.subscriptions.user_subscriptions'|trans({'%username%': user.username}) }}
        </h2>
    </div>

    <!-- Sub-tabs -->
    <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8">
            <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': 'users'}) }}" 
               class="{% if subscription_type == 'users' %}border-blue-500 text-blue-600{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                {{ 'profile.subscriptions.tab_users'|trans }}
            </a>
            <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': 'channels'}) }}" 
               class="{% if subscription_type == 'channels' %}border-blue-500 text-blue-600{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                {{ 'profile.subscriptions.tab_channels'|trans }}
            </a>
            <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': 'playlists'}) }}" 
               class="{% if subscription_type == 'playlists' %}border-blue-500 text-blue-600{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                {{ 'profile.subscriptions.tab_playlists'|trans }}
            </a>
            <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': 'models'}) }}" 
               class="{% if subscription_type == 'models' %}border-blue-500 text-blue-600{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                {{ 'profile.subscriptions.tab_models'|trans }}
            </a>
        </nav>
    </div>

    <!-- Content based on type -->
    {% if subscriptions|length > 0 %}
        <div class="text-sm text-gray-500 mb-4">
            {{ 'profile.subscriptions.total'|trans({'%count%': total_subscriptions}) }}
        </div>

        {% if subscription_type == 'users' %}
            {% include 'members/profile/subscriptions/_users.html.twig' %}
        {% elseif subscription_type == 'channels' %}
            {% include 'members/profile/subscriptions/_channels.html.twig' %}
        {% elseif subscription_type == 'playlists' %}
            {% include 'members/profile/subscriptions/_playlists.html.twig' %}
        {% elseif subscription_type == 'models' %}
            {% include 'members/profile/subscriptions/_models.html.twig' %}
        {% endif %}

        <!-- Pagination -->
        {% if total_pages > 1 %}
            <div class="flex justify-center">
                <nav class="flex items-center gap-2">
                    {% if current_page > 1 %}
                        <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': subscription_type, 'page': current_page - 1}) }}" 
                           class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                            {{ 'pagination.previous'|trans }}
                        </a>
                    {% endif %}

                    {% for page in range(max(1, current_page - 2), min(total_pages, current_page + 2)) %}
                        {% if page == current_page %}
                            <span class="px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-blue-600 rounded-md">
                                {{ page }}
                            </span>
                        {% else %}
                            <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': subscription_type, 'page': page}) }}" 
                               class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                                {{ page }}
                            </a>
                        {% endif %}
                    {% endfor %}

                    {% if current_page < total_pages %}
                        <a href="{{ path('user_profile_subscriptions', {'username': user.username, 'type': subscription_type, 'page': current_page + 1}) }}" 
                           class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                            {{ 'pagination.next'|trans }}
                        </a>
                    {% endif %}
                </nav>
            </div>
        {% endif %}
    {% else %}
        <div class="text-center py-12">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900">{{ 'profile.subscriptions.no_subscriptions'|trans }}</h3>
            <p class="mt-1 text-sm text-gray-500">
                {% if app.user and app.user.id == user.id %}
                    {% if subscription_type == 'users' %}
                        {{ 'profile.subscriptions.no_subscriptions_users_owner'|trans }}
                    {% elseif subscription_type == 'channels' %}
                        {{ 'profile.subscriptions.no_subscriptions_channels_owner'|trans }}
                    {% elseif subscription_type == 'playlists' %}
                        {{ 'profile.subscriptions.no_subscriptions_playlists_owner'|trans }}
                    {% elseif subscription_type == 'models' %}
                        {{ 'profile.subscriptions.no_subscriptions_models_owner'|trans }}
                    {% endif %}
                {% else %}
                    {{ 'profile.subscriptions.no_subscriptions_user'|trans }}
                {% endif %}
            </p>
        </div>
    {% endif %}
</div>
{% endblock %}
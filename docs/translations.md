# Система переводов в RexTube

## Обзор

RexTube использует систему переводов Symfony для поддержки многоязычности. Проект поддерживает русский (основной) и английский языки.

## Структура файлов переводов

### Расположение
Все файлы переводов находятся в папке `translations/`

### Форматы файлов
- **YAML** (`.yaml`) - рекомендуемый формат, удобный для редактирования
- **XLF** (`.xlf`) - XML формат, более структурированный

### Типы файлов переводов

| Файл | Назначение |
|------|------------|
| `messages.ru.yaml` | Основные переводы интерфейса |
| `security.ru.yaml` | Переводы для аутентификации и безопасности |
| `validators.ru.yaml` | Сообщения валидации форм |
| `AutocompleteBundle.ru.xlf` | Переводы для компонента автодополнения |

## Использование переводов в шаблонах

### Базовый синтаксис
```twig
{{ 'ключ.перевода'|trans }}
```

### Примеры
```twig
{{ 'nav.home'|trans }}           <!-- "Главная" -->
{{ 'nav.videos'|trans }}         <!-- "Видео" -->
{{ 'nav.categories'|trans }}     <!-- "Категории" -->
```

### Переводы с параметрами
```twig
{{ 'video.views_count'|trans({'%count%': video.views}) }}
{{ 'user.welcome'|trans({'%name%': user.username}) }}
```

### Использование доменов
```twig
{{ 'login.error'|trans({}, 'security') }}
{{ 'field.required'|trans({}, 'validators') }}
```

## Структура ключей переводов

### Иерархическая организация
Ключи переводов организованы иерархически для лучшей структуры:

```yaml
# Навигация
nav:
    home: "Главная"
    videos: "Видео"
    categories: "Категории"
    
# Видео
video:
    upload_page:
        title: "Загрузить видео"
        description: "Описание видео"
        submit: "Загрузить"
    detail_page:
        views: "Просмотры"
        duration: "Длительность"
        
# Аутентификация
auth:
    login:
        title: "Вход в систему"
        email: "Email"
        password: "Пароль"
        submit: "Войти"
```

### Рекомендации по именованию
- Используйте snake_case для ключей
- Группируйте по функциональности
- Используйте описательные имена
- Избегайте слишком глубокой вложенности (максимум 3-4 уровня)

## Добавление новых переводов

### Шаг 1: Определите домен
Выберите подходящий файл:
- `messages.ru.yaml` - для основного интерфейса
- `security.ru.yaml` - для аутентификации
- `validators.ru.yaml` - для валидации

### Шаг 2: Добавьте ключ в файл
Откройте `translations/messages.ru.yaml` и добавьте новый ключ:

```yaml
channel:
    edit:
        title: "Редактировать канал"
        description: "Описание канала"
        save_button: "Сохранить изменения"
        cancel_button: "Отмена"
```

### Шаг 3: Используйте в шаблоне
```twig
<h1>{{ 'channel.edit.title'|trans }}</h1>
<button type="submit">{{ 'channel.edit.save_button'|trans }}</button>
```

### Шаг 4: Добавьте английский перевод
В файле `translations/messages.en.yaml`:

```yaml
channel:
    edit:
        title: "Edit Channel"
        description: "Channel Description"
        save_button: "Save Changes"
        cancel_button: "Cancel"
```

## Переводы с плюрализацией

Для текстов, которые изменяются в зависимости от количества:

```yaml
video:
    views_count: "{0} просмотров нет|{1} %count% просмотр|]1,4] %count% просмотра|[5,Inf] %count% просмотров"
    comments_count: "{0} комментариев нет|{1} %count% комментарий|]1,4] %count% комментария|[5,Inf] %count% комментариев"
```

Использование:
```twig
{{ 'video.views_count'|trans({'%count%': video.views}) }}
```

## Команды для работы с переводами

### Извлечение новых ключей
Автоматически найти новые ключи переводов в шаблонах:
```bash
php bin/console translation:extract ru --force
```

### Обновление переводов
```bash
php bin/console translation:pull ru
```

### Очистка кеша переводов
```bash
php bin/console cache:clear
```

## Лучшие практики

### 1. Консистентность
- Используйте единый стиль именования
- Группируйте связанные переводы
- Поддерживайте одинаковую структуру для всех языков

### 2. Контекст
- Добавляйте комментарии для сложных переводов
- Указывайте контекст использования
- Используйте описательные ключи

### 3. Параметры
- Используйте параметры вместо конкатенации строк
- Именуйте параметры понятно: `%username%`, `%count%`

### 4. Валидация
- Проверяйте переводы на всех языках
- Тестируйте плюрализацию
- Убедитесь в корректности параметров

## Примеры использования

### Форма загрузки видео
```yaml
video:
    upload_page:
        title: "Загрузка видео"
        description: "Описание"
        categories: "Категории"
        tags: "Теги"
        submit: "Загрузить видео"
        success: "Видео успешно загружено"
        error: "Ошибка при загрузке видео"
```

### Навигация
```yaml
nav:
    home: "Главная"
    videos: "Видео"
    categories: "Категории"
    tags: "Теги"
    channels: "Каналы"
    community: "Сообщество"
    profile: "Профиль"
```

### Сообщения об ошибках
```yaml
error:
    404:
        title: "Страница не найдена"
        message: "Запрашиваемая страница не существует"
        back_home: "Вернуться на главную"
    403:
        title: "Доступ запрещен"
        message: "У вас нет прав для просмотра этой страницы"
```

## Отладка переводов

### Проверка отсутствующих переводов
В режиме разработки Symfony покажет отсутствующие ключи переводов.

### Логирование переводов
Включите логирование переводов в `config/packages/dev/monolog.yaml`:

```yaml
monolog:
    handlers:
        translation:
            type: stream
            path: "%kernel.logs_dir%/translation.log"
            level: debug
            channels: ["translation"]
```

### Профилировщик
Используйте Symfony Profiler для анализа переводов на странице.

## Заключение

Правильная организация переводов обеспечивает:
- Легкость поддержки многоязычности
- Консистентность интерфейса
- Простоту добавления новых языков
- Удобство для переводчиков

Следуйте этим рекомендациям для поддержания качественной системы переводов в проекте RexTube.